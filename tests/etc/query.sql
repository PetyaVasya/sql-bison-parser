SELECT customer.customer_id, ml_predict(ARRAY[customer.total_transactions, customer.total_amount_spent, customer.avg_transaction_value]) AS churn_probability, mongo_data.customer_segment FROM postgresql('public.customers', 'sql query') AS customer JOIN s3('fit_big_customer/*.parquet') AS parquet_data ON customer.customer_id = parquet_data.customer_id JOIN mongodb('dbname.customer', 'mongo query') AS mongo_data ON customer.customer_id = mongo_data.customer_id 